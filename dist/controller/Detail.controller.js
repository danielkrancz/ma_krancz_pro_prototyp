sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/m/MessageToast","sap/ui/core/routing/History","sap/m/MessageBox"],(e,t,o,i,a,s)=>{"use strict";return e.extend("at.hb.makrancz.procodeapp.controller.Detail",{aForm:{},onInit:function(){this._oModel=new t({createMode:false,editMode:false});this.getView().setModel(this._oModel,"ui");this.getOwnerComponent().getRouter().getRoute("Detail").attachPatternMatched(this._onPatternMatched,this)},_onPatternMatched:function(e){let t=e.getParameters().arguments.TravelID;if(t!=="-"){this._oModel.setProperty("/createMode",false);this.path=`/Travel('${t}')`;this.getView().bindElement(this.path);this.loadFragment("DisplayForm")}else{this._oModel.setProperty("/createMode",true);this.oCreatedContext=this.getView().getModel().createEntry("/Travel",{TravelID:"-"});this.getView().bindElement(this.oCreatedContext.getPath());this.loadFragment("EditForm")}},loadFragment:function(e){this.getView().byId("travelDetailSubSection").removeAllBlocks();if(!this.aForm[e]){o.load({id:this.getView().getId(),name:`at.hb.makrancz.procodeapp.view.fragment.${e}`,controller:this}).then(function(t){this.getView().addDependent(t);this.aForm[e]=t;this.getView().byId("travelDetailSubSection").addBlock(t)}.bind(this))}else{this.getView().byId("travelDetailSubSection").addBlock(this.aForm[e])}},onEdit:function(){this._oModel.setProperty("/editMode",true);this.loadFragment("EditForm")},onSave:function(){this.getView().getModel().submitChanges({success:()=>{i.show("Successfully saved.");if(this._oModel.getProperty("/createMode")){this.getOwnerComponent().getRouter().navTo("Detail",{TravelID:this.oCreatedContext.getObject().TravelID});this._oModel.setProperty("/createMode",false);this.loadFragment("DisplayForm")}else{this._oModel.setProperty("/editMode",false);this.loadFragment("DisplayForm")}}})},onCancel:function(){s.warning("Your entries will be lost when you leave this page.",{actions:["Leave Page","Cancel"],emphasizedAction:"Leave Page",initialFocus:"Cancel",onClose:e=>{if(e==="Leave Page"){this.getView().getModel().resetChanges({success:()=>{if(this.getView().getModel("ui").getProperty("/createMode")){this.onNavBack()}else{this._oModel.setProperty("/editMode",false);this.loadFragment("DisplayForm")}}})}}})},onNavBack(){const e=a.getInstance();const t=e.getPreviousHash();if(t!==undefined){window.history.go(-1)}else{const e=this.getOwnerComponent().getRouter();e.navTo("RouteMain",{},true)}},onDelete:function(){s.warning(`Delete object ${this.getView().getElementBinding().getBoundContext().getObject().TravelID}?`,{actions:["Delete","Cancel"],emphasizedAction:"Delete",initialFocus:"Cancel",onClose:e=>{if(e==="Delete"){this.getView().getModel().remove(this.getView().getElementBinding().getPath(),{success:()=>{this.onNavBack()}})}}})}})});
//# sourceMappingURL=Detail.controller.js.map